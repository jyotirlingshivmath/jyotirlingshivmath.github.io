<script>
const WEB_APP_URL = "PASTE_YOUR_WEB_APP_URL_HERE";

/* Auto receipt & date */
window.onload = function () {
  document.getElementById("rno").value =
    "SVV-" + Date.now().toString().slice(-5);
  document.getElementById("rdate").value =
    new Date().toISOString().slice(0, 10);
};

/* Search student */
function searchStudent() {
  const name = document.getElementById("searchName").value.trim();
  if (name.length < 2) return;

  fetch(WEB_APP_URL + "?action=searchStudent&name=" + encodeURIComponent(name))
    .then(r => r.json())
    .then(list => {
      if (!list || list.length === 0) {
        alert("Student not found");
        return;
      }

      const s = list[0];
      document.getElementById("admno").value = s.admno || "";
      document.getElementById("studentName").value = s.student_name || "";
      document.getElementById("fatherName").value = s.father_name || "";
      document.getElementById("className").value = s.class_name || "";
    });
}

/* Fee calculation */
function calcFee() {
  const t = Number(document.getElementById("total").value) || 0;
  const p = Number(document.getElementById("paid").value) || 0;
  const r = t - p;

  document.getElementById("received").innerText = p;
  document.getElementById("remain").value = r;
  document.getElementById("remainRow").style.display = r > 0 ? "" : "none";
}
</script>
