<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fee Receipt | SHIVMATH VEDIC VIDYALAYA</title>

<style>
@page{size:A4;margin:15mm;}
body{font-family:"Times New Roman";background:#eaeaea;}
.receipt{background:#fff;border:2px solid #000;padding:15px;width:720px;margin:auto;}
.header{text-align:center;border-bottom:2px solid #000;padding-bottom:8px;}
.header h2{margin:0;font-size:24px;}
.header h3{margin:2px;font-weight:normal;}
table{width:100%;border-collapse:collapse;margin-top:10px;font-size:15px;}
td{border:1px solid #000;padding:6px;}
.label{font-weight:bold;}
.amount{text-align:right;}
.total{font-weight:bold;background:#f2f2f2;}
.signature{height:45px;}
input,select{width:98%;font-size:15px;}
button{margin:10px;padding:6px 14px;font-size:14px;}
@media print{
 body{background:none;}
 button{display:none;}
}
</style>
</head>

<body>

<div class="receipt">

<div class="header">
<h2>SHIVMATH VEDIC VIDYALAYA</h2>
<h3>FEE RECEIPT (STUDENT COPY)</h3>
</div>

<table>

<tr>
<td class="label">Receipt No</td>
<td><input id="rno" readonly></td>
<td class="label">Date</td>
<td><input type="date" id="rdate"></td>
</tr>

<tr>
<td class="label">Search Student</td>
<td colspan="3">
<input type="text" id="searchName" placeholder="Type student name">
<button type="button" onclick="searchStudent()">Search</button>
</td>
</tr>

<tr>
<td class="label">Admission No</td>
<td><input id="admno" readonly></td>
<td class="label">Class</td>
<td><input id="className" readonly></td>
</tr>

<tr>
<td class="label">Student Name</td>
<td colspan="3"><input id="studentName" readonly></td>
</tr>

<tr>
<td class="label">Father Name</td>
<td colspan="3"><input id="fatherName" readonly></td>
</tr>

<tr>
<td class="label">Fee Month</td>
<td colspan="3">
<select id="feeMonth">
<option value="">-- Select Month --</option>
<option>January</option><option>February</option><option>March</option>
<option>April</option><option>May</option><option>June</option>
<option>July</option><option>August</option><option>September</option>
<option>October</option><option>November</option><option>December</option>
</select>
</td>
</tr>

<tr><td colspan="4" class="label">FEE DETAILS</td></tr>

<tr>
<td class="label">Total Fee</td>
<td colspan="3"><input id="totalFee" oninput="calcFee()"></td>
</tr>

<tr>
<td class="label">Paid Fee</td>
<td colspan="3"><input id="paidFee" oninput="calcFee()"></td>
</tr>

<tr id="remainRow">
<td class="label">Remaining Fee</td>
<td colspan="3"><input id="remainFee" readonly></td>
</tr>

<tr class="total">
<td class="label">Amount Received</td>
<td colspan="3" class="amount">
<span id="received">0</span> â‚¹
</td>
</tr>

<tr>
<td colspan="2" class="signature">Accountant Signature</td>
<td colspan="2" class="signature">Principal Signature</td>
</tr>

</table>
</div>

<center>
<button onclick="window.print()">Print Receipt</button>
</center>

<script>
// ================= INIT =================
document.getElementById("rno").value = "SVV-" + Date.now().toString().slice(-5);
document.getElementById("rdate").value = new Date().toISOString().slice(0,10);

// ================= SEARCH STUDENT =================
function searchStudent(){
    const key = document.getElementById("searchName").value.trim().toLowerCase();
    const students = JSON.parse(localStorage.getItem("students")) || [];

    if(key === ""){
        alert("Please type student name");
        return;
    }

    if(students.length === 0){
        alert("No admission data found.\nPlease save admission first.");
        return;
    }

    const student = students.find(s =>
        s.name && s.name.toLowerCase().includes(key)
    );

    if(!student){
        alert("Student not found");
        return;
    }

    // ===== AUTO FILL =====
    document.getElementById("admno").value = student.admno || "";
    document.getElementById("studentName").value = student.name || "";
    document.getElementById("fatherName").value = student.father || "";
    document.getElementById("className").value = student.studentClass || "";
}

// ================= FEE CALCULATION =================
function calcFee(){
    const total = Number(document.getElementById("totalFee").value) || 0;
    const paid = Number(document.getElementById("paidFee").value) || 0;
    const remain = total - paid;

    document.getElementById("received").innerText = paid;
    document.getElementById("remainFee").value = remain;

    document.getElementById("remainRow").style.display =
        remain > 0 ? "" : "none";
}
</script>

</body>
</html>
