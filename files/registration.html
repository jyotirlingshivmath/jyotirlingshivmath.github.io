<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Registration | ‡§∂‡§ø‡§µ‡§Æ‡§† ‡§µ‡•à‡§¶‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø</title>

<style>
body {
  font-family: 'Mukta', sans-serif;
  margin: 0;
  background-color: #fff8e1;
}

.header {
  background-color: #ffecb3;
  padding: 15px;
  text-align: center;
  font-size: 1.8rem;
  color: #4a148c;
  font-weight: bold;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.container {
  padding: 20px;
  max-width: 1200px;
  margin: auto;
}

h2 {
  color: #4a148c;
  margin-bottom: 10px;
}

form {
  background: #fff3e0;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 1px 2px 5px rgba(0,0,0,0.1);
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: flex-end;
}

form input, form select, form button {
  padding: 10px;
  border: 1px solid #e1bee7;
  border-radius: 6px;
  flex: 1 1 200px;
}

form button {
  background-color: #ffeb3b;
  color: darkred;
  font-weight: bold;
  border: none;
  cursor: pointer;
  transition: 0.3s ease;
}

form button:hover {
  background-color: #f3e5f5;
  color: #6a1b9a;
}

#searchInput {
  margin-bottom: 15px;
  padding: 10px;
  width: 100%;
  max-width: 400px;
  border-radius: 6px;
  border: 1px solid #e1bee7;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

table, th, td {
  border: 1px solid #e1bee7;
}

th, td {
  padding: 10px;
  text-align: left;
}

th {
  background-color: #ffecb3;
  color: #4a148c;
}

tr:nth-child(even) {
  background-color: #fff3e0;
}

.action-btn {
  padding: 5px 10px;
  margin: 0 2px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.edit-btn { background-color: #4a148c; color: #fff; }
.delete-btn { background-color: darkred; color: #fff; }

#video, #canvas {
  border: 1px solid #e1bee7;
  border-radius: 6px;
  max-width: 200px;
}

@media (max-width: 768px) {
  form { flex-direction: column; }
  form input, form select, form button { max-width: 100%; }
  #video, #canvas { max-width: 100%; }
}
</style>
</head>

<body>

<div class="header">üî± Student Registration - ‡§∂‡§ø‡§µ‡§Æ‡§† ‡§µ‡•à‡§¶‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø üî±</div>

<div class="container">

  <!-- Registration Form -->
  <h2>‡§õ‡§æ‡§§‡•ç‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§´‡•â‡§∞‡•ç‡§Æ</h2>
  <form id="regForm">
    <input type="text" id="studentName" placeholder="‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="date" id="dob" placeholder="‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø" required>
    <input type="text" id="studentClass" placeholder="‡§ï‡§ï‡•ç‡§∑‡§æ / Class" required>
    <input type="text" id="parentName" placeholder="‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="text" id="contact" placeholder="‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§®‡§Ç‡§¨‡§∞" required>
    <input type="text" id="address" placeholder="‡§™‡§§‡§æ" required>

    <!-- Camera -->
    <div>
      <video id="video" width="200" height="150" autoplay></video><br>
      <button type="button" id="snapBtn">Capture Photo</button>
      <canvas id="canvas" width="200" height="150" style="display:none;"></canvas>
    </div>

    <button type="submit">‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
    <input type="hidden" id="editIndex">
  </form>

  <!-- Search -->
  <input type="text" id="searchInput" placeholder="‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§∏‡•á ‡§ñ‡•ã‡§ú‡•á‡§Ç...">

  <!-- Registered Students Table -->
  <h2>‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§° ‡§õ‡§æ‡§§‡•ç‡§∞</h2>
  <table id="regTable">
    <thead>
      <tr>
        <th>‡§ï‡•ç‡§∞.‡§∏‡§Ç.</th>
        <th>Photo</th>
        <th>‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
        <th>‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø</th>
        <th>‡§ï‡§ï‡•ç‡§∑‡§æ</th>
        <th>‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï</th>
        <th>‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï</th>
        <th>‡§™‡§§‡§æ</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- records will appear here -->
    </tbody>
  </table>

</div>

<script>
// Camera Setup
let video = document.getElementById('video');
let canvas = document.getElementById('canvas');
let snapBtn = document.getElementById('snapBtn');
let photoData = '';

// Access webcam
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => {
    video.srcObject = stream;
  })
  .catch(err => {
    alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•à‡§Æ‡§∞‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡•§');
    console.error(err);
  });

snapBtn.addEventListener('click', () => {
  canvas.style.display = 'block';
  canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
  photoData = canvas.toDataURL('image/png');
});

// Data array
let students = [];
let regForm = document.getElementById('regForm');
let regTable = document.getElementById('regTable').getElementsByTagName('tbody')[0];
let searchInput = document.getElementById('searchInput');
let editIndexInput = document.getElementById('editIndex');

function renderTable(data) {
  regTable.innerHTML = '';
  data.forEach((student, index) => {
    let row = regTable.insertRow();
    row.insertCell(0).innerText = index + 1;

    let imgCell = row.insertCell(1);
    let img = document.createElement('img');
    img.src = student.photo || '';
    img.width = 50;
    img.height = 50;
    img.style.borderRadius = '50%';
    imgCell.appendChild(img);

    row.insertCell(2).innerText = student.name;
    row.insertCell(3).innerText = student.dob;
    row.insertCell(4).innerText = student.class;
    row.insertCell(5).innerText = student.parent;
    row.insertCell(6).innerText = student.contact;
    row.insertCell(7).innerText = student.address;

    let actionCell = row.insertCell(8);
    let editBtn = document.createElement('button');
    editBtn.innerText = 'Edit';
    editBtn.className = 'action-btn edit-btn';
    editBtn.onclick = () => editStudent(index);
    let delBtn = document.createElement('button');
    delBtn.innerText = 'Delete';
    delBtn.className = 'action-btn delete-btn';
    delBtn.onclick = () => deleteStudent(index);
    actionCell.appendChild(editBtn);
    actionCell.appendChild(delBtn);
  });
}

function editStudent(index) {
  let s = students[index];
  document.getElementById('studentName').value = s.name;
  document.getElementById('dob').value = s.dob;
  document.getElementById('studentClass').value = s.class;
  document.getElementById('parentName').value = s.parent;
  document.getElementById('contact').value = s.contact;
  document.getElementById('address').value = s.address;
  photoData = s.photo || '';
  if(photoData) {
    let ctx = canvas.getContext('2d');
    let img = new Image();
    img.onload = function(){ ctx.drawImage(img,0,0,canvas.width,canvas.height); }
    img.src = photoData;
    canvas.style.display = 'block';
  }
  editIndexInput.value = index;
}

function deleteStudent(index) {
  if(confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) {
    students.splice(index, 1);
    renderTable(students);
  }
}

regForm.addEventListener('submit', function(e) {
  e.preventDefault();
  let student = {
    name: document.getElementById('studentName').value,
    dob: document.getElementById('dob').value,
    class: document.getElementById('studentClass').value,
    parent: document.getElementById('parentName').value,
    contact: document.getElementById('contact').value,
    address: document.getElementById('address').value,
    photo: photoData
  };

  if(editIndexInput.value !== '') {
    students[editIndexInput.value] = student;
    editIndexInput.value = '';
  } else {
    students.push(student);
  }

  regForm.reset();
  canvas.style.display = 'none';
  photoData = '';
  renderTable(students);
});

// Search functionality
searchInput.addEventListener('keyup', function() {
  let query = this.value.toLowerCase();
  let filtered = students.filter(s => 
    s.name.toLowerCase().includes(query) || 
    s.class.toLowerCase().includes(query)
  );
  renderTable(filtered);
});
</script>

</body>
</html>
