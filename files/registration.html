function doPost(e) {
  try {
    const SHEET_ID = '12sTLSoyfTJ7dNTq_xwDqvjytTl4ZTSunXsFQg9syXGo';
    const sheet = SpreadsheetApp.openById(SHEET_ID).getSheetByName("Sheet1");

    // Form data parse kar rahe hai
    const data = {
      admno: e.parameter.admno,
      student_name: e.parameter.student_name,
      gender: e.parameter.gender,
      dob: e.parameter.dob,
      category: e.parameter.category,
      blood_group: e.parameter.blood_group,
      father_name: e.parameter.father_name,
      father_occ: e.parameter.father_occ,
      mother_name: e.parameter.mother_name,
      mother_occ: e.parameter.mother_occ,
      mobile: e.parameter.mobile,
      email: e.parameter.email,
      address: e.parameter.address,
      class_name: e.parameter.class_name,
      prev_school: e.parameter.prev_school,
      photo_filename: e.parameter.photo_filename || "",
      registration_date: e.parameter.registration_date
    };

    sheet.appendRow([
      new Date(),
      data.admno,
      data.student_name,
      data.gender,
      data.dob,
      data.category,
      data.blood_group,
      data.father_name,
      data.father_occ,
      data.mother_name,
      data.mother_occ,
      data.mobile,
      data.email,
      data.address,
      data.class_name,
      data.prev_school,
      data.photo_filename,
      data.registration_date
    ]);

    return ContentService
      .createTextOutput(JSON.stringify({ success: true }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    return ContentService
      .createTextOutput(JSON.stringify({
        success: false,
        error: err.message
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
